# 第十三章 哈希（hash）算法

哈希函数是密码学中的一个重要分支，该函数是一类数学函数，它可以在有限的合理时间内，将任意长度的消息变换成固定长度的二进制串，且不可逆，这个输出值就是哈希值，也叫散列值或消息摘要。以 hash 函数为基础的 hash 算法，在数字签名，实现数据完整性，merkle 树数据存储和检索等方面有着广泛的应用。
在比特币系统中使用了两个密码学 hash 函数，一个是 SHA256,另一个是 ripemd160。ripemd160 主要用于生成比特币地址，SHA256 是比特币链上几乎所有加密算法的 hash 函数。

## 1\. 技术原理

hash 函数也叫散列函数，杂凑函数。它是一种单向密码机制，也就是只能加密，而不能解密。数学表达式可以为：h=H(m)，其中 H 是哈希函数，m 是要加密的信息，h 是输出的固定长度的哈希值。运算过程是设定一个初始向量，对消息补长到算法要求长度，将补长后的消息拆分成 N 份数据块，N 份数据块与初始向量通过 hash 算法进行迭代循环运算，最终得到固定长度的 hash 值。
hash 函数具有以下特点：

1.  压缩性：对任意长度的信息加密成固定长度的 hash 值；
2.  单向性：hash 函数的数学原理没有逆运算，所以不能将 hash 值转换成加密前的信息；
3.  抗碰撞性：hash 函数的运算过程相当复杂，包含多种数学运算和大量变量循环运算，要满足两个不同的消息产生相同的 hash 值几乎不可能发生；
4.  高灵敏性：任何微小的输入都有可能对输出产生巨大的影响。
    典型的 hash 函数有两类：消息摘要算法（MD5）和安全散列算法（SHA）。

## 2\. hash 碰撞

理想的 hash 函数对于不同的输入得到两个不同的 hash 值。在实际中，如果存在两个不同的信息 m，m'使 H(m)=H(m')，那么就称 m 和 m'是该函数的一个碰撞。简言之，hash 碰撞是指两个不同的消息在同一个哈希函数作用下，产生两个相同的哈希值。
为了保证数据安全性和不可篡改性，实际 hash 算法要足够复杂使其有很强的 hash 抗碰撞性。
hash 抗碰撞性分为两种：一种是弱抗碰撞性，即指定的消息 x 和函数 H，去求消息 y，使 H(x)=H(y)在计算上是不可行的；另一个是强抗碰撞性，即给定函数 H，对于任意一对不同的消息 x 和 y，使得 H(x)=H(y)在计算上也是不可行的。
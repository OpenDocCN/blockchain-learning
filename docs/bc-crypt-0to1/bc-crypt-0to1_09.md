# 第九章 非对称加密算法

非对称加密也叫公钥密码。
1976 年 Diffie 和 Hellman 首次提出了一种全新的加密思想，公钥密码体制思想。在当时几乎所有的密码体制都是对称密码体制，原理都是基于替换和置换这些较简单方法。公钥密码体制完全与之不同，它是非对称的，有两个不同的密钥，分别是公钥和私钥，加密的原理也不是之前的简单置换或替换，而是一些复杂的数学函数。这些数学函数都是基于数学难题。其所依据的难题一般分为三类：大整数分解问题类、离散对数问题类、椭圆曲线类。有时也把椭圆曲线类归为离散对数类。公钥密码体制是一次革命性的变革，突破了原有的密码体制模式，它解决了传统密码体制的两个大难题：密钥分配和数字签名。

## 1 非对称加密的概述

传统密码体制用的都是一个密钥，发送方传输密钥给接收方成本很高，而且风险很大。接收方收到的密文如果在传输过程中被修改，接收方无法判断密文的真伪性。公钥体制完美地解决了上述问题。它有一对密钥，一个是公钥，完全公开，任何人都可以收到该密钥；另一个是私钥，自己保存，不需要告诉任何人。通过公开的公钥是无法计算出私钥的，所以私钥是安全的。发送方 A 用公钥对明文进行加密，接收方 B 用对应的私钥进行解密。为保证传输密文的完整性和消息来源的准确性，需要对密文进行数字签名。A 对密文用自己的私钥进行再次加密，此过程叫数字签名；B 接收到密文用该私钥对应的公钥进行解密，此过程叫验签。
所以公钥密码体制可以分为两个模型：加密解密模型和签名验签模型。两个模型可以独立使用，也可以一起混用。具体按照自己的应用场景使用，一般情况下发送的密文都是需要进行数字签名的，发送的内容包括密文和签名两部分。接受者先进行验签，验签通过后，再进行解密。
非对称加密的方式有很多，以下讲解 RSA，DSA，ECDSA 这三种加密方式。

## 2 公钥密码体制的要求

公钥密码体制要想实现必须满足以下要求：
1.产生一对密钥对，即公私钥对，在计算上是容易的；
2.通过公钥对明文进行加密，在计算上是容易的；
3.通过私钥对密文进行解密，在计算上是容易的；
4.已知公钥，无法计算出私钥；
5.已知公钥和密文，无法计算出明文；
6.加密和解密的顺序可以交换。

目前满足以上要求，建立公钥密码体制基于的困难问题有较多，我只分析以下两种常用的：
1.大整数分解问题
若已知两个大素数 p 和 q，求 n=pq 是很容易的，但是已知 n，求 p 和 q 是几乎不可能的，这就是大整数分解问题。
2.离散对数问题
先了解两个概念，阶和原根。
设 m > 1 且 (a, m) = 1, 则使得 a^t ≡ 1 mod m 成立的最小的正整数 t 称为 a 对模 m 的阶, 记为δm(a)。
原根，是一个数学符号。设 m 是正整数，a 是整数，若 a 模 m 的阶等于φ(m)，则称 a 为模 m 的一个原根。里面提到的φ(m)是 m 质因数的个数。
给定一个公式 a^t mod b ≡ c，其中 a 是 b 的原根，b 是一个超大的素数，c 是小于 b 大于 0 的正整数。问题是已知 a，t，b 求 c 很容易，但是已知 a，b，c 求 t 非常困难。这就是离散对数问题。
举个例子（b 取个小值）：根据给定的 t 求 3^t mod 17 很容易。t=1 时，得 3；t=2 时，得 9；t=3 时，得 10，等等最终的结果都是在小于 17 大于 0 的正整数。但是现在 3^t mod 17≡12，求 t。求解过程非常困难，而且满足条件的 t 不计其数。这里用的是 17，如果换成很大的数，那几乎没有可能求解出来真正的 t。
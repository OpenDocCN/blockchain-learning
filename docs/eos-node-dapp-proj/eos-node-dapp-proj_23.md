# ä¸ƒã€.5 åŒæ­¥åŒºå—åŠŸèƒ½è®¾è®¡ä¸å®ç°

ä¸Šä¸€å°èŠ‚è®²è¿°äº†æ“åˆåŠŸèƒ½çš„ä¸šåŠ¡å®ç°ï¼Œé‚£ä¹ˆæœ¬å°èŠ‚å°†ä»‹ç»å¦‚ä½•å‘ç°é“¾ä¸Šæ“åˆæˆäº¤æ—¥å¿—ï¼Œå¦‚ä½•å¢é‡åŒæ­¥è®¢å•æ•°æ®è‡³ä¸­å¿ƒåŒ–æ•°æ®åº“ä»¥åŠå¦‚ä½•æ ¹æ®è§„åˆ’å®æ—¶æ›´æ–° K çº¿å›¾æŠ¥è¡¨æ•°æ®

## åŠŸèƒ½ä»‹ç»

åŒºå—åŒæ­¥åŠŸèƒ½ï¼Œä¸»è¦æ˜¯é€šè¿‡å®šæ—¶è°ƒåº¦ï¼Œå®æ—¶æ£€æŸ¥é“¾ä¸Šæˆäº¤è®¢å•ä¿¡æ¯ï¼Œå¦‚æœæ–°æˆäº¤è®¢å•åˆ™åŒæ­¥è‡³çº¿ä¸‹æˆäº¤è®¢å•åº“ï¼Œå¹¶æŒ‰ä¸€å®šä¸šåŠ¡è§„åˆ™æ›´æ–° K çº¿å›¾æŠ¥è¡¨æ•°æ®ã€‚

## æ•°æ®ç»“æ„

**æˆäº¤è®¢å•è¡¨**

| å­—æ®µ | æ•°æ®ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| ä¸»é”® | bigint |  |
| äº¤æ˜“å¯¹ ID | bigint |  |
| æˆäº¤é‡ | bigint |  |
| æˆäº¤ä»·æ ¼ | bigint |  |
| æˆäº¤æ—¶é—´ | timestamp |  |
| ä¹°æ–¹å¸æˆ· | varchar |  |
| ä¹°æ–¹ä»·æ ¼ | bigint |  |
| ä¹°æ–¹è®¢å• ID | bigint |  |
| ä¹°æ–¹å¤‡æ³¨ | varchar |  |
| å–æ–¹å¸æˆ· | varchar |  |
| å–æ–¹ä»·æ ¼ | bigint |  |
| å–æ–¹è®¢å• ID | bigint |  |
| å–æ–¹å¤‡æ³¨ | varchar |  |
| æœ€åæ›´æ–°æ—¶é—´ | timestamp |  |
| æœ€åæ›´æ–°åŒºå— | bigint |  |

**K çº¿å›¾æŠ¥è¡¨**

| å­—æ®µ | æ•°æ®ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| äº¤æ˜“å¯¹ ID | bigint |  |
| æ—¶é—´ | bigint | æŒ‰åˆ†é’Ÿæ±‡æ€»æˆäº¤è®¢å•æ•°æ® |
| å¼€ç›˜ä»· | bigint | å½“å‰åŒºé—´ç»´åº¦å¼€ç›˜ç¬¬ä¸€å•æˆäº¤ä»·ï¼›æ¯”å¦‚ï¼šæŒ‰æ—¥çº¿å›¾æŸ¥è¯¢æ—¶ï¼Œè‹¥å¼€ç›˜åŠå°æ—¶å†…æ— æˆäº¤ä»·åˆ™å–å‰ä¸€å¤©æ”¶ç›˜ä»·ï¼› |
| æ”¶ç›˜ä»· | bigint | å½“å‰åŒºé—´ç»´åº¦æœ€åä¸€å•æˆäº¤ä»· |
| æœ€é«˜ä»· | bigint | å½“å‰åŒºé—´ç»´åº¦æœ€é«˜ä»· |
| æœ€ä½ä»· | bigint | å½“å‰åŒºé—´ç»´åº¦æœ€ä½ä»· |
| æˆäº¤é‡ | bigint | å½“å‰åŒºé—´ç»´åº¦æ€»æˆäº¤é‡å•æ•° |

## è°ƒåº¦é…ç½®

æ ¹æ® cron è¡¨è¾¾å¼è§¦å‘è°ƒåº¦ä»»åŠ¡ã€‚

## æƒé™è¦æ±‚

åŒæ­¥åŠŸèƒ½åªæ˜¯æŸ¥è¯¢åˆçº¦æ•°æ®å¹¶åŒæ­¥è‡³æœ¬åœ°åº“ï¼Œå¯¹æ™ºèƒ½åˆçº¦æ— å®‰å…¨æ€§é—®é¢˜ã€‚

## æŠ€æœ¯å®ç°

æœ¬åŠŸèƒ½å®ç°é€»è¾‘ï¼Œå¯æ‹†åˆ†ä¸ºä¸‰ä¸ªä¸šåŠ¡æ¨¡å—å®ç°ï¼š

1.  å¦‚ä½•æŸ¥è¯¢é“¾ä¸Šæˆäº¤è®°å½•
    æŸ¥è¯¢é“¾ä¸Šæˆäº¤æ•°æ®ï¼ŒåŸç†æ˜¯é€šè¿‡è°ƒç”¨`eos.getActions(contractname, pos, offset)`æ–¹æ³•ç­›é€‰åˆçº¦ä¸­çš„æ—¥å¿—æ–¹æ³•ï¼Œä»è€Œè·å–å…·ä½“çš„æˆäº¤æ˜ç»†ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯æä¾›æŸ¥è¯¢çš„é“¾èŠ‚ç‚¹å¿…é¡»äº‹å…ˆåŠ è½½ history_plugin æ’ä»¶ï¼Œå¦åˆ™æŸ¥åˆ°çš„æ•°æ®ä¸ºç©ºã€‚æ‰€ä»¥å°†æ¥éƒ¨ç½²æœåŠ¡æ—¶ï¼Œéœ€è¦æ³¨æ„æ‰€è¦é“¾æ¥çš„èŠ‚ç‚¹ä¸ç®¡æ˜¯è‡ªå·±æ­å»ºè¿˜æ˜¯ç¬¬ä¸‰æ–¹é“¾ç»“ç‚¹éƒ½å¿…é¡»é…ç½® history_plugin æ’ä»¶ã€‚
2.  åŒæ­¥é“¾ä¸Šæˆäº¤è®°å½•è‡³æœ¬åœ°è®¢å•è¡¨
    å½“æŸ¥è¯¢åˆ°é“¾ä¸Šæˆäº¤è®°å½•åï¼Œéœ€è¦**å¢é‡åŒæ­¥**è‡³æœ¬åœ°åº“ã€‚å…³äºå¢é‡çš„å¤„ç†å¯ä»¥æ ¹æ®å½“å‰åº“ä¸­æœ€åä¸€æ¡è®°å½•çš„åŒºå— ID ä¸é“¾ä¸ŠåŒºå— ID å¯¹æ¯”å¤„ç†ã€‚
3.  æ ¹æ®æŠ¥è¡¨è¦æ±‚èšåˆæˆäº¤æ•°æ®è‡³ K çº¿å›¾æŠ¥è¡¨
    å› ä¸º K çº¿å›¾æ”¯æŒ 5 åˆ†é’Ÿã€10 åˆ†é’Ÿã€æŒ‰å°æ—¶ã€æŒ‰å¤©ç­‰ä¸åŒç»´åº¦çš„æ•°æ®æŸ¥çœ‹ï¼Œè€ƒè™‘åˆ°æ•°æ®åº“æ€§èƒ½è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç»´åº¦å¯¹å¤šæŠ¥è¡¨(åˆ†é’Ÿè¡¨ã€ å°æ—¶è¡¨ã€å¤©è¡¨)è¿›è¡Œæ•°æ®èšåˆæ›´æ–°ã€‚æ³¨æ„ï¼šåœ¨èšåˆæ•°æ®æ—¶ï¼Œéœ€è¦å¼€ç›˜ä»·ã€æ”¶ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½è§„åˆ™è¿›è¡Œå¤„ç†åå†æ›´æ–°ã€‚

* * *

é€šè¿‡æœ¬å°èŠ‚çš„å­¦ä¹ ã€æ€è€ƒä¸åŠ¨æ‰‹å®è·µï¼Œæˆ‘ä»¬å®Œæˆäº†é“¾ä¸Šæˆäº¤è®¢å•çš„æ•°æ®åŒæ­¥ä»¥åŠ K çº¿å›¾æŠ¥è¡¨æ•°æ®çš„æ›´æ–°ã€‚

* * *

> åœ¨æ•™ç¨‹ä¸­å¦‚å‡ºç°é”™è¯¯ğŸ›æˆ–ä¸æ˜“ç†è§£çš„çŸ¥è¯†ç‚¹ï¼Œæ¬¢è¿åŠ æˆ‘å¾®ä¿¡æŒ‡æ­£! Name: zhangliang | WeChat: rushking2009 | Mail: zhangliang@cldy.org

![Show me your code.](img/9c507c40d372f5692d061c802a44deb2.jpg "åŠ ç¾¤äº†è§£")![](img/aab6c923225b0a35b6580de17534641d.jpg)

æ³¨ï¼š æœ‰æƒ³äº†è§£**æ„¿ç å…¨æ€ç»´ IT å·¥ç¨‹å¸ˆåŠ é€Ÿå™¨**çš„æœ‹å‹ï¼Œå¯ä»¥æ‰«ç åŠ ç¾¤å’¨è¯¢ã€‚

* * *

### **changelog**

2019-03-04 zhangliang

*   åˆæ¬¡å‘ç¨¿